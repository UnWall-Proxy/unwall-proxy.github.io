<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>UnWall Proxy Status</title>
  <style>
    /* === Starry Night Background === */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: "Source Sans Pro", sans-serif;
      color: white;
      overflow: hidden;
    }
    body {
      background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
    }
    .stars, .stars2, .stars3 {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      display: block;
      background: transparent;
      z-index: 0;
    }
    .stars:after, .stars2:after, .stars3:after {
      content: " ";
      position: absolute;
      top: 0;
      left: 0;
      width: 1px;
      height: 1px;
      background: transparent;
      box-shadow: /* star positions here – for brevity you can paste your original box-shadow list */;
    }
    .stars {
      animation: animStar 50s linear infinite;
    }
    .stars2 {
      animation: animStar 100s linear infinite;
    }
    .stars3 {
      animation: animStar 150s linear infinite;
    }
    @keyframes animStar {
      from {transform: translateY(0);}
      to {transform: translateY(-2000px);}
    }

    /* === Status Circle === */
    .status-indicator {
      position: fixed;
      top: 20px;
      left: 20px;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: gray;
      cursor: pointer;
      box-shadow: 0 0 8px rgba(0,0,0,0.5);
      z-index: 10;
      transition: background 0.3s ease, box-shadow 0.3s ease;
    }
    .status-online { background: #28a745; box-shadow: 0 0 10px #28a745; }
    .status-offline { background: #dc3545; box-shadow: 0 0 10px #dc3545; }

    /* === Access Button === */
    .access-btn {
      position: fixed;
      top: 15px;
      right: 20px;
      background: #007bff;
      color: white;
      padding: 0.6rem 1rem;
      border: none;
      border-radius: 5px;
      font-size: 0.95rem;
      cursor: pointer;
      z-index: 10;
      transition: background 0.3s ease;
    }
    .access-btn:hover { background: #0056b3; }

    /* === Popup === */
    .status-popup {
      position: fixed;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.85);
      padding: 2rem;
      color: #ececec;
      border-radius: 8px;
      display: none;
      text-align: center;
      z-index: 1001;
      box-shadow: 0 0 15px rgba(0,0,0,0.8);
    }
    .status-popup h2 { margin-bottom: 1rem; font-weight: 400; }
    .status-popup button {
      padding: 0.6rem 1.2rem;
      font-size: 0.95rem;
      margin: 0.5rem;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .btn-visit { background: #007bff; color: white; }
    .btn-visit:hover { background: #0056b3; }
    .btn-close { background: #6c757d; color: white; }
    .btn-close:hover { background: #555; }
  </style>
</head>
<body>
  <!-- Starfield Layers -->
  <div class="stars"></div>
  <div class="stars2"></div>
  <div class="stars3"></div>

  <!-- Status Circle -->
  <div class="status-indicator" id="statusCircle" title="Click for details"></div>

  <!-- Access Button -->
  <button class="access-btn" id="accessBtn">Visit Site</button>

  <!-- Popup -->
  <div class="status-popup" id="statusPopup">
    <h2 id="popupTitle">Checking status…</h2>
    <button class="btn-visit" id="popupVisit">Visit Site</button>
    <button class="btn-close" id="closeBtn">Close</button>
  </div>

  <script src="https://cdn.jsdelivr.net/gh/alfg/ping.js@0.2.2/dist/ping.min.js"></script>
  <script>
    const ping = new Ping({ timeout: 5000 });
    const circle = document.getElementById('statusCircle');
    const popup = document.getElementById('statusPopup');
    const title = document.getElementById('popupTitle');
    const popupVisit = document.getElementById('popupVisit');
    const closeBtn = document.getElementById('closeBtn');
    const accessBtn = document.getElementById('accessBtn');

    const siteMainUrl = 'https://unwallproxy.duckdns.org';
    const sitePingUrl = siteMainUrl + '/favicon.ico';

    function checkStatus() {
      ping.ping(sitePingUrl)
        .then(time => {
          circle.classList.add('status-online');
          circle.classList.remove('status-offline');
          title.textContent = `Online – ping: ${Math.round(time)} ms`;
        })
        .catch(() => {
          circle.classList.add('status-offline');
          circle.classList.remove('status-online');
          title.textContent = `Offline or unreachable`;
        });
    }

    circle.addEventListener('click', () => popup.style.display = 'block');
    closeBtn.addEventListener('click', () => popup.style.display = 'none');

    popupVisit.addEventListener('click', () => window.open(siteMainUrl, '_blank'));
    accessBtn.addEventListener('click', () => window.open(siteMainUrl, '_blank'));

    // Initial check + refresh every 15 seconds
    checkStatus();
    setInterval(checkStatus, 15000);
  </script>
</body>
</html>
